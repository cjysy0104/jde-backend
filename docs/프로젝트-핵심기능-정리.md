JustDoEat(맛집 리뷰 서비스) – 개인 담당 핵심 구현 기능 정리

핵심 구현 기능 (줄바꿈으로 구분)

레스토랑 목록 조회 (무한 스크롤)
레스토랑 키워드 검색 (식당명·주소 기준)
레스토랑별 리뷰 목록 조회 API
레스토랑 목록·검색 시 N+1 방지 (대표 썸네일 스칼라 서브쿼리로 1회 조회)
커서 기반 페이지네이션 (cursor, size, size+1 패턴)
댓글 신고 등록 (중복 신고 방지)
리뷰 신고 등록 (중복 신고 방지)
신고 카테고리 조회
관리자용 댓글 신고 목록·상세·키워드 검색·처리
관리자용 리뷰 신고 목록·상세·키워드 검색·처리


기술적 상세 설명 (선택)

레스토랑
- GET /api/restaurants: RestaurantQueryDTO(cursor, scroll)로 커서 기반 무한 스크롤. MyBatis 동적 SQL로 cursor 없을 때·있을 때 한 쿼리로 처리, FETCH FIRST size+1 ROWS ONLY로 다음 페이지 존재 여부 판단.
- GET /api/restaurants/search: RestaurantSearchDTO(keyword, cursor, scroll)로 식당명(NORMAL_NAME)·주소(ADDRESS) LIKE 검색, 동일하게 커서·size+1 적용.
- GET /api/restaurants/{restaurantNo}/reviews: PathVariable로 restaurantNo 전달 후 기존 ReviewService.getReviewList 재사용.
- N+1 해결: 목록·검색 SELECT 절에 스칼라 서브쿼리로 레스토랑당 대표 썸네일(좋아요 최다 리뷰의 FILE_URL) 1건만 조회. 쿼리 수 1+N → 1로 축소.
- request null 시 서비스에서 빈 DTO 생성 후 정규화, @Transactional(readOnly = true) 적용.

신고
- POST /api/reports/comment, /api/reports/review: CustomUserDetails에서 memberNo 주입, DTO로 신고 등록. 서비스에서 동일 회원·동일 댓글/리뷰 신고 건수 조회 후 1건 이상이면 DuplicateReportException. VO 빌드 시 reportProcess "PENDING", createdAt/updateAt 설정 후 insert, 결과 1건 아니면 IllegalStateException.
- GET /api/reports/categories: 신고 사유 카테고리 목록 조회.
- 관리자: GET/PUT /api/admin/reports/comment, /review (목록 페이징, 상세, 키워드 검색, 처리 상태 변경). ReportPageResponse, CommentReportProcessDTO, ReviewReportProcessDTO 등으로 응답·요청 구조화.


느낀점 / 성장 포인트

- 목록 API를 만들 때 "한 번에 많이 조회하면 되지 않나?"라고 생각했는데, 레스토랑마다 썸네일을 따로 조회하다 보니 쿼리 수가 1+N으로 늘어나는 문제를 겪었습니다. 스칼라 서브쿼리로 한 번에 가져오도록 수정한 뒤, 설계 단계에서 N+1 가능성을 미리 점검하는 습관이 생겼습니다.
- 신고 기능을 사용자(등록·카테고리 조회)와 관리자(목록·상세·검색·처리)로 나누어 구현하면서, 같은 도메인이라도 역할에 따라 API 스펙과 응답 구조를 나누는 연습을 할 수 있었습니다. 중복 신고 방지처럼 서비스 계층에서 검증 로직을 두는 것의 중요성을 느꼈습니다.
- 커서 기반 무한 스크롤을 적용하면서 cursor가 없을 때와 있을 때를 하나의 쿼리로 처리하는 동적 SQL, size+1로 다음 페이지 여부를 판단하는 패턴을 직접 구현해 보며, 목록형 API 설계에 대한 이해가 깊어졌습니다.
- 팀에서 사용하는 공통 유틸(예: 스크롤 정규화)을 레스토랑·리뷰·댓글 등 여러 도메인에서 일관되게 쓰는 구조를 경험했고, 공통화된 로직을 활용해 구현 속도를 높이는 것의 장점을 체감했습니다.
